metabolism <- read.csv("~/Box/PhD/Research/Lake-Tanganyika/1_Code/Metabolism-Summary/metabolism.tsv", header=T, sep="\t")
lookup.metabolism <- read.csv("~/Box/PhD/Research/Lake-Tanganyika/1_Code/Metabolism-Summary/lookup_metabolism.tsv", header=T, sep="\t")
library(dplyr)
colnames(metabolism)
str(metabolism)
summary(metabolism)
library(tidyverse)
# Ok but I want a column that says Comammox if it genes amoA, nxrA and nxrB > 0
metabolism$Comammox <- ifelse(metabolism$amoA >0 & metabolism$nitrite_oxidoreductase_nxrA >0 & metabolism$nitrite_oxidoreductase_nxrB>0, 1, NA)
colnames(metabolism)
summary(metabolism)
metabolism.gathered <- metabolism %>% gather(key="Genes",value="Nb.of.genes",c(9:138))
metabolism.gathered.categories <- left_join(metabolism.gathered,lookup.metabolism, by="Genes")
head(metabolism.gathered.categories)
summary(metabolism.gathered.categories)
library(ggplot2)
library(plyr)
library(scales)
metabolism.m <- ddply(metabolism.gathered.categories, .(Genes), transform,rescale = rescale(Nb.of.genes))
var_width = 5
metabolism.m <- mutate(metabolism.m, short_reaction_name = str_wrap(Reaction, width = var_width))
# Remove cysC and cysN
metabolism.m <- metabolism.m %>% filter(!Genes %in% c("cysC","cysN"))
nitrogen.taxa <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("NITROGEN","UREASE")) %>% summarise(NG = n_distinct(Taxonomy))
nitrogen.mags <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("NITROGEN","UREASE")) %>% summarise(NG = n_distinct(MAG))
ggplot(metabolism.m %>% filter(!is.na(rescale) & Category %in% c("NITROGEN","UREASE")), aes(x=Genes,y=Taxonomy))+
geom_tile(aes(fill = Nb.of.genes),colour = "white") +
scale_fill_gradient(low = "light blue", high="steelblue")+
ggtitle("Nitrogen", subtitle=paste0(nitrogen.taxa," taxonomic groups and ", nitrogen.mags, " distinct MAGs"))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
facet_grid(Domain ~ short_reaction_name, scales="free",space = "free_y")
# SULFUR:
s.taxa <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("SULFUR","DSR","Thiosulfate oxidation")) %>% summarise(NG = n_distinct(Taxonomy))
s.mags <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("SULFUR","DSR","Thiosulfate oxidation")) %>% summarise(NG = n_distinct(MAG))
s.table <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("SULFUR","DSR","Thiosulfate oxidation"))
# convert the reaction to the right order:
s.table$short_reaction_name_f = factor(s.table$short_reaction_name, levels=c("sulfide\noxidation","strongly\nassociated\nwith\nsulfur\noxidation","sulfur\noxidation",
"sulfate\nreduction","sulfite\nreduction","associated\nwith\nthe\nelectron\ntransport\nchain",
"ancillary\ngenes","core\ngenes"))
ggplot(s.table, aes(x=Genes,y=Taxonomy))+
geom_tile(aes(fill = Nb.of.genes),colour = "white") +
scale_fill_gradient(low = "light blue", high="steelblue")+
theme_bw()+
facet_grid(Domain~short_reaction_name_f, scales="free",space = "free_y")+
ggtitle("Sulfur",subtitle=paste0(s.taxa," taxonomic groups and ", s.mags, " distinct MAGs"))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# Hydrogen:
H.taxa <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("HYDROGEN")) %>% summarise(NG = n_distinct(Taxonomy))
H.mags <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("HYDROGEN")) %>% summarise(NG = n_distinct(MAG))
ggplot(metabolism.m %>% filter(!is.na(rescale) & Category %in% c("HYDROGEN")), aes(x=Genes,y=Taxonomy))+
geom_tile(aes(fill = Nb.of.genes),colour = "white") +
scale_fill_gradient(low = "light blue", high="steelblue")+
ggtitle("Hydrogen",subtitle=paste0(H.taxa," taxonomic groups and ", H.mags, " distinct MAGs"))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
facet_grid(Domain~short_reaction_name, scales="free",space = "free_y")
# Oxygen
O.taxa <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("OXYGEN")) %>% summarise(NG = n_distinct(Taxonomy))
O.mags <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("OXYGEN")) %>% summarise(NG = n_distinct(MAG))
ggplot(metabolism.m %>% filter(!is.na(rescale) & Category %in% c("OXYGEN")), aes(x=Genes,y=Taxonomy))+
geom_tile(aes(fill =Nb.of.genes),colour = "white") +
scale_fill_gradient(low = "light blue", high="steelblue")+
ggtitle("Oxygen",subtitle=paste0(O.taxa," taxonomic groups and ", O.mags, " distinct MAGs"))+
theme_bw()+
facet_grid(Domain~short_reaction_name, scales="free",space = "free_y")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#Carbon:
C.taxa <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("METHANE","C1 METABOLISM","C MONOXIDE","CARBON FIXATION")) %>% summarise(NG = n_distinct(Taxonomy))
C.mags <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("METHANE","C1 METABOLISM","C MONOXIDE","CARBON FIXATION")) %>% summarise(NG = n_distinct(MAG))
ggplot(metabolism.m %>% filter(!is.na(rescale) & Category %in% c("METHANE","C1 METABOLISM","C MONOXIDE","CARBON FIXATION")), aes(x=Genes,y=Taxonomy))+
geom_tile(aes(fill =Nb.of.genes),colour = "white") +
scale_fill_gradient(low = "light blue", high="steelblue")+
theme_bw()+
facet_grid(Domain~short_reaction_name, scales="free",space = "free_y")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Carbon",subtitle=paste0(C.taxa," taxonomic groups and ", C.mags, " distinct MAGs"))
#Other metabolism:
other.taxa <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("HALOGENATED COMPOUNDS","ARSENIC","SELENIUM","NITRILES","METALS")) %>% summarise(NG = n_distinct(Taxonomy))
other.mags <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("HALOGENATED COMPOUNDS","ARSENIC","SELENIUM","NITRILES","METALS")) %>% summarise(NG = n_distinct(MAG))
ggplot(metabolism.m %>% filter(!is.na(rescale) & Category %in% c("HALOGENATED COMPOUNDS","ARSENIC","SELENIUM","NITRILES","METALS")), aes(x=Genes,y=Taxonomy))+
geom_tile(aes(fill =  Nb.of.genes),colour = "white") +
scale_fill_gradient(low = "light blue", high="steelblue")+
theme_bw()+
facet_grid(Domain~short_reaction_name, scales="free",space = "free_y")+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Other",subtitle=paste0(other.taxa," taxonomic groups and ", other.mags, " distinct MAGs"))
summary.stats <- as.data.frame(matrix(nrow=6, ncol=3))
colnames(summary.stats) <- c("Category","Number.of.Taxa","Number.of.MAGs")
summary.stats$Category<- c("Nitrogen","Sulfur","Hydrogen","Oxygen","Carbon","Other")
summary.stats$Number.of.Taxa <- c(nitrogen.taxa,s.taxa,H.taxa,O.taxa,C.taxa,other.taxa)
summary.stats$Number.of.MAGs <- c(nitrogen.mags,s.mags,H.mags,O.mags,C.mags,other.mags)
to.plot.summary <- gather(data= summary.stats, key="Category_attribute",value="ToPlot",c(2:3))
to.plot.summary$ToPlot <- as.numeric(to.plot.summary$ToPlot)
bar.plot <- ggplot(to.plot.summary, aes(x=factor(Category),y=ToPlot,fill=factor(Category_attribute))) +
geom_bar(stat="identity", position=position_dodge())+
scale_fill_discrete(name = "Shown", labels = c("Number of MAGs", "Number of Taxa"))+
theme_minimal()+
theme(text = element_text(size=20))+
xlab("Biogeochemical category")+
ylab("Count")
bar.plot
list.N_cycling.MAGS <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("NITROGEN","UREASE")) %>% distinct(MAG)
list.S <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("SULFUR","DSR","Thiosulfate oxidation")) %>% distinct(MAG)
list.H <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("HYDROGEN")) %>% distinct(MAG)
list.O <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("OXYGEN")) %>% distinct(MAG)
list.C <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("METHANE","C1 METABOLISM","C MONOXIDE","CARBON FIXATION")) %>% distinct(MAG)
list.other <- metabolism.m %>% filter(!is.na(rescale) & Category %in% c("HALOGENATED COMPOUNDS","ARSENIC","SELENIUM","NITRILES","METALS")) %>% distinct(MAG)
abund <- read.table("~/Box/PhD/Research/Lake-Tanganyika/1_Code/Figure3-RankAbundanceCurve/Abundance-MAGS.tsv", sep="\t", header=T)
lookup.samples <- read.table("~/Box/PhD/Research/Lake-Tanganyika/1_Code/Cyano-vs-SQR-genomes/sample_look_up.tsv", sep="\t", header=T)
abund.N <- abund %>% filter(MAG %in% list.N_cycling.MAGS$MAG)
colnames(abund.N)
abund.N <- abund.N %>% gather("Sample","Coverage",c(4:27))
abund.N <- left_join(abund.N,lookup.samples,by="Sample")
plot(x=abund.N$Coverage, y=-(abund.N$Depth), main="Nitrogen", xlab="Coverage", ylab="Depth",xlim=c(0,400))
abline(h=-100,col="grey",lty=2)
abline(h=-50,col="grey",lty=2)
abline(h=-70,col="red",lty=2)
## ggplot version coloured by reaction:
ggplot(abund.N, aes(x=Coverage, y=Depth))+
geom_point()
## ggplot version coloured by reaction:
ggplot(abund.N, aes(x=Coverage, y=Depth))+
geom_point()+
scale_y_reverse( lim=c(1250,0))
View(abund.N)
View(metabolism)
## ggplot version coloured by reaction:
abund.N.rxn <- left_join(abund.N, metabolism.m, by="MAG")
View(abund.N.rxn)
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes)), aes(x=Coverage, y=Depth, col=))+
geom_point()+
scale_y_reverse( lim=c(1250,0))
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes)), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
scale_y_reverse( lim=c(1250,0))
View(abund.N)
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes))& Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
scale_y_reverse( lim=c(1250,0))
abund.N.rxn %>% filter(!is.na(Nb.of.genes))& Category %in% c("NITROGEN","UREASE")
abund.N.rxn %>% filter(!is.na(Nb.of.genes)) & Category %in% c("NITROGEN","UREASE")
abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE"))
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
scale_y_reverse( lim=c(1250,0))
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~Category)
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~Reaction)+
scale_y_reverse( lim=c(1250,0))
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~Reaction)+
scale_y_reverse( lim=c(1250,0))+
theme(legend.position = "bottom")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~Reaction)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~short_reaction_name_f)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~short_reaction_name)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~short_reaction_name)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~short_reaction_name)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")+
geom_line(y=c(50,100, col="black"))+
geom_line(y=70, col="red")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~short_reaction_name)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")+
geom_line(y=50, col="black"))+
geom_line(y=70, col="red")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
facet_grid(~short_reaction_name)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")+
geom_line(y=50, col="black")+
geom_line(y=70, col="red")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=50, col="black")+
geom_line(y=70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse( lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")
abund.S.rxn <- left_join(abund.S, metabolism.m, by="MAG")
abund <- read.table("~/Box/PhD/Research/Lake-Tanganyika/1_Code/Figure3-RankAbundanceCurve/Abundance-MAGS.tsv", sep="\t", header=T)
lookup.samples <- read.table("~/Box/PhD/Research/Lake-Tanganyika/1_Code/Cyano-vs-SQR-genomes/sample_look_up.tsv", sep="\t", header=T)
abund.N <- abund %>% filter(MAG %in% list.N_cycling.MAGS$MAG)
colnames(abund.N)
abund.N <- abund.N %>% gather("Sample","Coverage",c(4:27))
abund.N <- left_join(abund.N,lookup.samples,by="Sample")
plot(x=abund.N$Coverage, y=-(abund.N$Depth), main="Nitrogen", xlab="Coverage", ylab="Depth",xlim=c(0,400))
abline(h=-100,col="grey",lty=2)
abline(h=-50,col="grey",lty=2)
abline(h=-70,col="red",lty=2)
##  S
abund.S <- abund %>% filter(MAG %in% list.S$MAG)
colnames(abund.S)
abund.S <- abund.S %>% gather("Sample","Coverage",c(4:27))
abund.S <- left_join(abund.S,lookup.samples,by="Sample")
plot(x=abund.S$Coverage, y=-(abund.S$Depth), main="Sulfur", xlab="Coverage", ylab="Depth", xlim=c(0,400))
abline(h=-100,col="grey",lty=2)
abline(h=-50,col="grey",lty=2)
abline(h=-70,col="red",lty=2)
# H
abund.H <- abund %>% filter(MAG %in% list.H$MAG)
colnames(abund.H)
abund.H <- abund.H %>% gather("Sample","Coverage",c(4:27))
abund.H <- left_join(abund.H,lookup.samples,by="Sample")
plot(x=abund.H$Coverage, y=-(abund.H$Depth), main="Hydrogen", xlab="Coverage", ylab="Depth", xlim=c(0,400))
abline(h=-100,col="grey",lty=2)
abline(h=-50,col="grey",lty=2)
abline(h=-70,col="red",lty=2)
# O
abund.O <- abund %>% filter(MAG %in% list.O$MAG)
colnames(abund.O)
abund.O <- abund.O %>% gather("Sample","Coverage",c(4:27))
abund.O <- left_join(abund.O,lookup.samples,by="Sample")
plot(x=abund.O$Coverage, y=-(abund.O$Depth), main="Oxygen", xlab="Coverage", ylab="Depth", xlim=c(0,400))
abline(h=-100,col="grey",lty=2)
abline(h=-50,col="grey",lty=2)
abline(h=-70,col="red",lty=2)
# C
abund.C <- abund %>% filter(MAG %in% list.C$MAG)
colnames(abund.C)
abund.C <- abund.C %>% gather("Sample","Coverage",c(4:27))
abund.C <- left_join(abund.C,lookup.samples,by="Sample")
plot(x=abund.C$Coverage, y=-(abund.C$Depth), main="Carbon", xlab="Coverage", ylab="Depth", xlim=c(0,400))
abline(h=-100,col="grey",lty=2)
abline(h=-50,col="grey",lty=2)
abline(h=-70,col="red",lty=2)
# Other
abund.other <- abund %>% filter(MAG %in% list.other$MAG)
colnames(abund.other)
abund.other <- abund.other %>% gather("Sample","Coverage",c(4:27))
abund.other <- left_join(abund.other,lookup.samples,by="Sample")
plot(x=abund.other$Coverage, y=-(abund.other$Depth),main="Other", xlab="Coverage", ylab="Depth",xlim=c(0,400))
abline(h=-100,col="grey",lty=2)
abline(h=-50,col="grey",lty=2)
abline(h=-70,col="red",lty=2)
abund.S.rxn <- left_join(abund.S, metabolism.m, by="MAG")
ggplot(abund.S.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("SULFUR","DSR","Thiosulfate oxidation")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in sulfur cycling reactions")
abund.C.rxn <- left_join(abund.C, metabolism.m, by="MAG")
abund.C.rxn <- left_join(abund.C, metabolism.m, by="MAG")
ggplot(abund.S.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("METHANE","C1 METABOLISM","C MONOXIDE","CARBON FIXATION")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom")+
ggtitle("Distribution of MAGs involved in carbon cycling reactions")
## now plot the abundance by Biogeochem cycle:
pdf("~/Box/PhD/Research/Lake-Tanganyika/1_Code/Metabolism-Summary/Distribution-organisms-by-reactions.pdf", width = 16 , height = 10, title = "Lake Tanganyika MAGs and Metabolism")
## ggplot version coloured by reaction:
abund.N.rxn <- left_join(abund.N, metabolism.m, by="MAG")
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom",axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")
abund.S.rxn <- left_join(abund.S, metabolism.m, by="MAG")
ggplot(abund.S.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("SULFUR","DSR","Thiosulfate oxidation")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom",axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Distribution of MAGs involved in sulfur cycling reactions")
abund.C.rxn <- left_join(abund.C, metabolism.m, by="MAG")
ggplot(abund.S.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("METHANE","C1 METABOLISM","C MONOXIDE","CARBON FIXATION")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom",axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Distribution of MAGs involved in carbon cycling reactions")
dev.off()
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom",axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")
library(ggplot2)
library(tidyverse)
ggplot(abund.N.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("NITROGEN","UREASE")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom",axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Distribution of MAGs involved in nitrogen cycling reactions")
ggplot(abund.S.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("SULFUR","DSR","Thiosulfate oxidation")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom",axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Distribution of MAGs involved in sulfur cycling reactions")
ggplot(abund.C.rxn %>% filter(!is.na(Nb.of.genes) & Category %in% c("METHANE","C1 METABOLISM","C MONOXIDE","CARBON FIXATION")), aes(x=Coverage, y=Depth, col=Reaction))+
geom_point()+
geom_line(y=-50, col="black")+
geom_line(y=-100, col="black")+
geom_line(y=-70, col="red")+
facet_grid(~short_reaction_name)+
scale_y_reverse(lim=c(1250,0))+
theme_bw()+
theme(legend.position = "bottom",axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("Distribution of MAGs involved in carbon cycling reactions")
